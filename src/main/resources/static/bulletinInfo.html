<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>信息</title>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <link href="css/bulletin_info.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div class="t-top"><!--头部-->
    <a href="bulletin.html"><img src="images/icon_return.png"></a>
    <div onMouseOut="$('#t-nav').hide();" onMouseOver="$('#t-nav').show();">
        <span>修改公告</span>
    </div>

</div><!--头部-->

<div class="t-main1">
    <div class="t-main1-list" >
        <!--<label>公告内容：</label><input type="text" id = "title" class="name-input" />-->
        <span style="text-align: center;">公告内容</span><textarea id="title" rows="5" cols="40"></textarea>
    </div>

</div>

<div>
    <a id="toUpdate" class="btn" onclick=toUpdate() >确定修改</a>
    <a id="toDelete" class="btn" onclick=toDelete() >确定删除</a>
</div>
</body>
<script>

    $(function(){
        var id = parseInt(UrlParam.paramValues("id"));
        console.log(id);
        var params ={};
        params.id = id;
        $.ajax({
            url: "/notice/goUpdateNoticePage",
            type: 'POST',
            dataType: "json",
            contentType: 'application/json',
            data: JSON.stringify(params),
            success: function(data){
                var json = JSON.stringify(data);
                // showData(data);//数据展示
                // document.getElementById('title').value = json;
                $("#title").val(data);
                console.log(data);
                console.log(json);
            },
            error: function(msg){
                alert("ajax连接异常："+msg);
            }
        });
    });

    function toUpdate(){
        var title = document.getElementById("title").value;
        var id = parseInt(UrlParam.paramValues("id"));
        console.log(id);
        var params ={};
        params.id = id;
        params.title = title;
        $.ajax({
            url: "/notice/updateNotice",
            type: 'POST',
            dataType: "json",
            contentType: 'application/json',
            data: JSON.stringify(params),
            success: function (data) {
                console.log(data);
                // alert("1111111");
                if(data===1) {
                    alert("修改成功");
                    window.location.href='bulletin.html';
                }
            },
            error: function (data) {
            }
        });

    }

    function toDelete(){
        var id = parseInt(UrlParam.paramValues("id"));
        console.log(id);
        var params ={};
        params.id = id;
        $.ajax({
            url: "/notice/deleteNotice",
            type: 'POST',
            dataType: "json",
            contentType: 'application/json',
            data: JSON.stringify(params),
            success: function (data) {
                console.log(data);
                // alert("1111111");
                if(data===1) {
                    alert("修改成功");
                    window.location.href='bulletin.html';
                }
            },
            error: function (data) {
            }
        });

    }

    UrlParam = function() { // url参数
        var data, index;
        (function init() {
            data = []; //值，如[["1","2"],["zhangsan"],["lisi"]]
            index = {}; //键:索引，如{a:0,b:1,c:2}
            var u = window.location.search.substr(1);
            if (u != '') {
                var params = decodeURIComponent(u).split('&');
                for (var i = 0, len = params.length; i < len; i++) {
                    if (params[i] != '') {
                        var p = params[i].split("=");
                        if (p.length == 1 || (p.length == 2 && p[1] == '')) {// p | p= | =
                            data.push(['']);
                            index[p[0]] = data.length - 1;
                        } else if (typeof(p[0]) == 'undefined' || p[0] == '') { // =c 舍弃
                            continue;
                        } else if (typeof(index[p[0]]) == 'undefined') { // c=aaa
                            data.push([p[1]]);
                            index[p[0]] = data.length - 1;
                        } else {// c=aaa
                            data[index[p[0]]].push(p[1]);
                        }
                    }
                }
            }
        })();
        return {
            // 获得参数,类似request.getParameter()
            param : function(o) { // o: 参数名或者参数次序
                try {
                    return (typeof(o) == 'number' ? data[o][0] : data[index[o]][0]);
                } catch (e) {
                }
            },
            //获得参数组, 类似request.getParameterValues()
            paramValues : function(o) { // o: 参数名或者参数次序
                try {
                    return (typeof(o) == 'number' ? data[o] : data[index[o]]);
                } catch (e) {}
            },
            //是否含有paramName参数
            hasParam : function(paramName) {
                return typeof(paramName) == 'string' ? typeof(index[paramName]) != 'undefined' : false;
            },
            // 获得参数Map ,类似request.getParameterMap()
            paramMap : function() {
                var map = {};
                try {
                    for (var p in index) { map[p] = data[index[p]]; }
                } catch (e) {}
                return map;
            }
        }
    }();


</script>


</html>
